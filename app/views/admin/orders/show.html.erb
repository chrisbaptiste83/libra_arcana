<div class="flex items-center justify-between mb-6">
  <h1 class="font-heading text-2xl font-bold gradient-gold-text">Order #<%= @order.id %></h1>
  <%= link_to "Back to Orders", admin_orders_path, class: "btn-outline-gold text-sm" %>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
  <div class="card-dark p-5 !transform-none">
    <p class="text-xs text-gray-500 uppercase tracking-wider mb-1">Status</p>
    <span class="badge-<%= @order.status == 'completed' ? 'gold' : 'purple' %> text-base"><%= @order.status.capitalize %></span>
    <%= form_with(model: [:admin, @order], class: "mt-3") do |f| %>
      <div class="flex gap-2">
        <%= f.select :status, %w[pending completed failed], {}, class: "input-dark text-sm flex-1" %>
        <%= f.submit "Update", class: "btn-gold text-xs !py-1.5 !px-3" %>
      </div>
    <% end %>
  </div>
  <div class="card-dark p-5 !transform-none">
    <p class="text-xs text-gray-500 uppercase tracking-wider mb-1">Total</p>
    <p class="text-2xl font-bold text-gold">$<%= '%.2f' % @order.total %></p>
  </div>
  <div class="card-dark p-5 !transform-none">
    <p class="text-xs text-gray-500 uppercase tracking-wider mb-1">Customer</p>
    <p class="text-gray-200"><%= @order.user.full_name %></p>
    <p class="text-sm text-gray-500"><%= @order.user.email %></p>
  </div>
</div>

<div class="card-dark p-5 !transform-none mb-6">
  <h3 class="font-heading text-lg font-semibold text-gray-200 mb-4">Order Details</h3>
  <dl class="grid grid-cols-2 md:grid-cols-4 gap-4">
    <div>
      <dt class="text-xs text-gray-500 uppercase">Placed</dt>
      <dd class="text-gray-200 text-sm"><%= @order.created_at.strftime("%B %d, %Y %I:%M %p") %></dd>
    </div>
    <div>
      <dt class="text-xs text-gray-500 uppercase">Stripe Session</dt>
      <dd class="text-gray-400 text-xs font-mono"><%= @order.stripe_session_id || "-" %></dd>
    </div>
    <% if @order.payment %>
      <div>
        <dt class="text-xs text-gray-500 uppercase">Payment Status</dt>
        <dd class="text-gray-200 text-sm"><%= @order.payment.status.capitalize %></dd>
      </div>
      <div>
        <dt class="text-xs text-gray-500 uppercase">Stripe Payment ID</dt>
        <dd class="text-gray-400 text-xs font-mono"><%= @order.payment.stripe_payment_id || "-" %></dd>
      </div>
    <% end %>
  </dl>
</div>

<h3 class="font-heading text-lg font-semibold text-gray-200 mb-4">Items</h3>
<div class="card-dark overflow-hidden !transform-none">
  <table class="table-dark">
    <thead>
      <tr>
        <th>Ebook</th>
        <th>Author</th>
        <th class="text-right">Unit Price</th>
      </tr>
    </thead>
    <tbody>
      <% @order.order_items.each do |item| %>
        <tr>
          <td class="text-gray-200"><%= item.ebook.title %></td>
          <td class="text-gray-400 text-sm"><%= item.ebook.author %></td>
          <td class="text-right text-gold">$<%= '%.2f' % item.unit_price %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
